cache:
  - directories:
    - /tmp/texlive
git:
  submodules: false    
os:
  - linux
dist: xenial
addons:
  apt:
    packages: ghostscript 
install:
  - export PATH="/tmp/texlive/bin/x86_64-linux:$PATH";
  - |
    if ! command -v tlmgr > /dev/null; then
        REMOTE="http://mirror.ctan.org/systems/texlive/tlnet";
        INSTALL="/tmp/install-texlive";
        mkdir -p $INSTALL;
        curl -sSL $REMOTE/install-tl-unx.tar.gz | tar -xzv -C $INSTALL \
            --strip-components=1;
        echo "selected_scheme scheme-basic" >> $INSTALL/tl.profile;
        echo "collection-fontsrecommended 1" >> $INSTALL/tl.profile;
        echo "collection-latex 1" >> $INSTALL/tl.profile;
        echo "collection-xetex 1" >> $INSTALL/tl.profile;
        echo "TEXDIR /tmp/texlive" >> $INSTALL/tl.profile;
        echo "TEXMFLOCAL /tmp/texlive/texmf-local" >> $INSTALL/tl.profile;
        echo "TEXMFSYSCONFIG /tmp/texlive/texmf-config" >> $INSTALL/tl.profile;
        echo "TEXMFSYSVAR /tmp/texlive/texmf-var" >> $INSTALL/tl.profile;
        echo "tlpdbopt_autobackup 0" >> $INSTALL/tl.profile;
        echo "tlpdbopt_install_docfiles 0" >> $INSTALL/tl.profile;
        echo "tlpdbopt_install_srcfiles 0" >> $INSTALL/tl.profile;
        $INSTALL/install-tl -profile $INSTALL/tl.profile;        
        tlmgr install beamer etoolbox translator caption mathtools algorithms float footmisc;          
    fi
script:
  - make all
deploy:
  provider: releases
  api_key: $GITHUB_TOKEN
  file: build/*.pdf
  skip_cleanup: true
  on:
    tags: true